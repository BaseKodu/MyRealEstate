# Generated by Django 5.1.3 on 2025-02-28 11:57

import django.core.validators
import django.db.models.deletion
import djmoney.models.fields
import myrealestate.common.models
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('companies', '0002_alter_company_options_remove_company_contact_email_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='BodyCorporate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('property_type', models.CharField(choices=[('es', 'Estate'), ('bu', 'Building'), ('un', 'Unit')], max_length=2)),
                ('property_id', models.IntegerField()),
                ('name', models.CharField(max_length=255)),
                ('contact_person', models.CharField(blank=True, max_length=255, null=True)),
                ('contact_email', models.EmailField(blank=True, max_length=254, null=True)),
                ('contact_phone', models.CharField(blank=True, max_length=20, null=True)),
                ('monthly_levy_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('monthly_levy', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Regular monthly levy amount', max_digits=22)),
                ('special_levy_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('special_levy', myrealestate.common.models.CurrencyField(decimal_places=4, default=Decimal('0'), help_text='Any special levy currently in effect', max_digits=22)),
                ('special_levy_end_date', models.DateField(blank=True, null=True)),
                ('levy_increase_month', models.PositiveIntegerField(choices=[(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10), (11, 11), (12, 12)], default=1, help_text='Month when levies typically increase')),
                ('payment_day', models.PositiveIntegerField(help_text='Day of month when payment is due', validators=[django.core.validators.MinValueValidator(1)])),
                ('account_number', models.CharField(blank=True, max_length=100, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='body_corporates', to='companies.company')),
            ],
            options={
                'verbose_name_plural': 'Body corporates',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='FinancialCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True, null=True)),
                ('category_type', models.CharField(choices=[('I', 'Income'), ('E', 'Expense')], max_length=1)),
                ('is_default', models.BooleanField(default=False)),
                ('is_tax_deductible', models.BooleanField(default=False, help_text='Indicates if this expense category is tax deductible')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='financial_categories', to='companies.company')),
            ],
            options={
                'verbose_name_plural': 'Financial categories',
                'ordering': ['name'],
                'unique_together': {('name', 'company', 'category_type')},
            },
        ),
        migrations.CreateModel(
            name='MunicipalAccount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('property_type', models.CharField(choices=[('es', 'Estate'), ('bu', 'Building'), ('un', 'Unit')], max_length=2)),
                ('property_id', models.IntegerField()),
                ('municipality', models.CharField(help_text='Name of municipality', max_length=255)),
                ('account_number', models.CharField(max_length=100)),
                ('account_holder', models.CharField(max_length=255)),
                ('includes_water', models.BooleanField(default=True)),
                ('includes_electricity', models.BooleanField(default=True)),
                ('includes_sewage', models.BooleanField(default=True)),
                ('includes_refuse', models.BooleanField(default=True)),
                ('includes_rates', models.BooleanField(default=True)),
                ('billing_day', models.PositiveIntegerField(help_text='Day of month when bill is typically issued', validators=[django.core.validators.MinValueValidator(1)])),
                ('payment_day', models.PositiveIntegerField(help_text='Day of month when payment is due', validators=[django.core.validators.MinValueValidator(1)])),
                ('municipal_valuation_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3, null=True)),
                ('municipal_valuation', myrealestate.common.models.CurrencyField(blank=True, decimal_places=4, help_text='Municipal valuation for rates calculation', max_digits=22, null=True)),
                ('valuation_date', models.DateField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='municipal_accounts', to='companies.company')),
            ],
            options={
                'ordering': ['municipality', 'account_number'],
            },
        ),
        migrations.CreateModel(
            name='PropertyPurchase',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('property_type', models.CharField(choices=[('es', 'Estate'), ('bu', 'Building'), ('un', 'Unit')], max_length=2)),
                ('property_id', models.IntegerField()),
                ('purchase_date', models.DateField()),
                ('purchase_price_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('purchase_price', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Purchase price', max_digits=22)),
                ('purchase_type', models.CharField(choices=[('in', 'Individual'), ('bu', 'Business'), ('tr', 'Trust')], default='bu', max_length=2)),
                ('transfer_duty_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('transfer_duty', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Transfer duty paid to SARS', max_digits=22)),
                ('is_vat_applicable', models.BooleanField(default=False, help_text='If true, VAT was paid instead of transfer duty')),
                ('vat_amount_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('vat_amount', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='VAT amount if applicable (usually 15% of purchase price)', max_digits=22)),
                ('bond_registration_cost_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('bond_registration_cost', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Cost to register the bond', max_digits=22)),
                ('transfer_cost_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('transfer_cost', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Cost to transfer the property', max_digits=22)),
                ('conveyancing_fees_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('conveyancing_fees', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Legal fees for conveyancing', max_digits=22)),
                ('deeds_office_fees_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('deeds_office_fees', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Fees paid to the Deeds Office', max_digits=22)),
                ('down_payment_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('down_payment', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Initial payment/deposit', max_digits=22)),
                ('financing_amount_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('financing_amount', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Amount financed (bond)', max_digits=22)),
                ('bond_registration_fee_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('bond_registration_fee', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Fee to register the bond', max_digits=22)),
                ('bond_initiation_fee_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('bond_initiation_fee', myrealestate.common.models.CurrencyField(decimal_places=4, help_text="Bank's initiation fee for the bond", max_digits=22)),
                ('municipal_rates_clearance_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('municipal_rates_clearance', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Municipal rates clearance certificate fee', max_digits=22)),
                ('levy_clearance_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('levy_clearance', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Levy clearance certificate fee (for sectional title)', max_digits=22)),
                ('occupational_rent_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('occupational_rent', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Occupational rent if applicable', max_digits=22)),
                ('initial_repair_costs_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('initial_repair_costs', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Initial repairs or renovations', max_digits=22)),
                ('purchase_notes', models.TextField(blank=True, null=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='property_purchases', to='companies.company')),
            ],
            options={
                'ordering': ['-purchase_date'],
            },
        ),
        migrations.CreateModel(
            name='PropertyBond',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('lender', models.CharField(help_text='Bank or financial institution', max_length=255)),
                ('account_number', models.CharField(blank=True, max_length=100, null=True)),
                ('bond_amount_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('bond_amount', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Total bond amount', max_digits=22)),
                ('start_date', models.DateField()),
                ('term_years', models.PositiveIntegerField(help_text='Bond term in years')),
                ('interest_rate_type', models.CharField(choices=[('fx', 'Fixed Rate'), ('va', 'Variable Rate'), ('mx', 'Mixed Rate')], default='va', max_length=2)),
                ('current_interest_rate', models.DecimalField(decimal_places=2, help_text='Current annual interest rate (%)', max_digits=5, validators=[django.core.validators.MinValueValidator(0)])),
                ('prime_linked', models.BooleanField(default=True, help_text='Is rate linked to prime rate?')),
                ('prime_rate_margin', models.DecimalField(decimal_places=2, default=0, help_text='Margin above/below prime rate (%)', max_digits=5)),
                ('monthly_payment_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('monthly_payment', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Regular monthly bond payment', max_digits=22)),
                ('payment_day', models.PositiveIntegerField(help_text='Day of month when payment is due', validators=[django.core.validators.MinValueValidator(1)])),
                ('is_active', models.BooleanField(default=True)),
                ('initiation_fee_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('initiation_fee', myrealestate.common.models.CurrencyField(decimal_places=4, default=Decimal('0'), max_digits=22)),
                ('has_payment_holiday', models.BooleanField(default=False)),
                ('payment_holiday_end_date', models.DateField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='property_bonds', to='companies.company')),
                ('property_purchase', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='bonds', to='finances.propertypurchase')),
            ],
            options={
                'ordering': ['-start_date'],
            },
        ),
        migrations.CreateModel(
            name='RecurringTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('transaction_type', models.CharField(choices=[('in', 'Income'), ('ex', 'Expense')], max_length=10)),
                ('property_type', models.CharField(choices=[('es', 'Estate'), ('bu', 'Building'), ('un', 'Unit')], max_length=2)),
                ('property_id', models.IntegerField()),
                ('amount_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('amount', myrealestate.common.models.CurrencyField(decimal_places=4, help_text='Amount', max_digits=22)),
                ('includes_vat', models.BooleanField(default=True, help_text='Does this amount include VAT?')),
                ('vat_amount_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('vat_amount', myrealestate.common.models.CurrencyField(decimal_places=4, default=Decimal('0'), help_text='VAT portion of the amount', max_digits=22)),
                ('frequency', models.CharField(choices=[('da', 'Daily'), ('we', 'Weekly'), ('bw', 'Every Two Weeks'), ('mo', 'Monthly'), ('qu', 'Quarterly'), ('sa', 'Semi-Annually'), ('an', 'Annually')], max_length=15)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField(blank=True, null=True)),
                ('next_due_date', models.DateField()),
                ('vendor', models.CharField(blank=True, max_length=255, null=True)),
                ('vendor_vat_number', models.CharField(blank=True, max_length=20, null=True)),
                ('description', models.TextField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('is_tax_deductible', models.BooleanField(default=False)),
                ('body_corporate', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='recurring_transactions', to='finances.bodycorporate')),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='recurring_transactions', to='finances.financialcategory')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='recurring_transactions', to='companies.company')),
                ('municipal_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='recurring_transactions', to='finances.municipalaccount')),
                ('property_bond', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='recurring_transactions', to='finances.propertybond')),
                ('tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tenant_recurring_transactions', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['next_due_date'],
            },
        ),
        migrations.CreateModel(
            name='FinancialTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('transaction_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('transaction_type', models.CharField(choices=[('in', 'Income'), ('ex', 'Expense')], max_length=10)),
                ('property_type', models.CharField(choices=[('es', 'Estate'), ('bu', 'Building'), ('un', 'Unit')], max_length=2)),
                ('property_id', models.IntegerField()),
                ('amount_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('amount', myrealestate.common.models.CurrencyField(decimal_places=4, default=Decimal('0'), help_text='Transaction amount', max_digits=22)),
                ('includes_vat', models.BooleanField(default=True, help_text='Does this amount include VAT?')),
                ('vat_amount_currency', djmoney.models.fields.CurrencyField(choices=[('ZAR', 'South African Rand')], default='ZAR', editable=False, max_length=3)),
                ('vat_amount', myrealestate.common.models.CurrencyField(decimal_places=4, default=Decimal('0'), help_text='VAT portion of the amount', max_digits=22)),
                ('date', models.DateField()),
                ('due_date', models.DateField(blank=True, null=True)),
                ('payment_method', models.CharField(blank=True, choices=[('ca', 'Cash'), ('ch', 'Check'), ('cc', 'Credit Card'), ('bt', 'Bank Transfer'), ('ep', 'Electronic Payment'), ('do', 'Debit Order'), ('ot', 'Other')], max_length=20, null=True)),
                ('reference_number', models.CharField(blank=True, max_length=100, null=True)),
                ('vendor', models.CharField(blank=True, max_length=255, null=True)),
                ('vendor_vat_number', models.CharField(blank=True, help_text='VAT registration number of vendor', max_length=20, null=True)),
                ('description', models.TextField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, null=True)),
                ('is_tax_deductible', models.BooleanField(default=False, help_text='Is this expense tax deductible?')),
                ('tax_year', models.IntegerField(blank=True, help_text='Tax year this transaction belongs to', null=True)),
                ('attachment', models.FileField(blank=True, null=True, upload_to='financial/attachments/%Y/%m/')),
                ('is_paid', models.BooleanField(default=True)),
                ('payment_date', models.DateField(blank=True, help_text='Date when payment was made or received', null=True)),
                ('body_corporate', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='transactions', to='finances.bodycorporate')),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='transactions', to='finances.financialcategory')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='financial_transactions', to='companies.company')),
                ('tenant', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='tenant_transactions', to=settings.AUTH_USER_MODEL)),
                ('municipal_account', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='transactions', to='finances.municipalaccount')),
                ('property_bond', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='transactions', to='finances.propertybond')),
            ],
            options={
                'ordering': ['-date'],
                'indexes': [models.Index(fields=['transaction_type'], name='finances_fi_transac_ade4e8_idx'), models.Index(fields=['property_type', 'property_id'], name='finances_fi_propert_fb5325_idx'), models.Index(fields=['date'], name='finances_fi_date_894c42_idx'), models.Index(fields=['is_paid'], name='finances_fi_is_paid_27fec7_idx'), models.Index(fields=['tax_year'], name='finances_fi_tax_yea_c4be0e_idx')],
            },
        ),
    ]
